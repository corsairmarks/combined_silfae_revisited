@enslaved_percentage_high = 0.75
@enslaved_percentage_medium = 0.5
@enslaved_percentage_low = 0.25
@enslaved_percentage_critical = 0.1
@enslaved_percentage_none = 0.01
@enslaved_pop_modifier_duration_days = 120

# THIS = country
calculate_shadowyrep_morale = {
	if = {
		limit = {
			pop_percentage = {
				percentage > @enslaved_percentage_high
				limit = { is_enslaved = yes }
			}
		}
		if = {
			limit = { NOT = { has_modifier = slreptilian_illusion_40 } }
			add_modifier = { modifier = slreptilian_illusion_40 }
		}
		switch = {
			trigger = has_modifier
			slreptilian_illusion_30 = { remove_modifier = slreptilian_illusion_30 }
			slreptilian_illusion_20 = { remove_modifier = slreptilian_illusion_20 }
			slreptilian_illusion_10 = { remove_modifier = slreptilian_illusion_10 }
			slreptilian_illusion_0 = { remove_modifier = slreptilian_illusion_0 }
		}
	}
	else_if = {
		limit = {
			pop_percentage = {
				percentage > @enslaved_percentage_medium
				limit = { is_enslaved = yes }
			}
		}
		if = {
			limit = { NOT = { has_modifier = slreptilian_illusion_30 } }
			add_modifier = { modifier = slreptilian_illusion_30 }
		}
		switch = {
			trigger = has_modifier
			slreptilian_illusion_40 = { remove_modifier = slreptilian_illusion_40 }
			slreptilian_illusion_20 = { remove_modifier = slreptilian_illusion_20 }
			slreptilian_illusion_10 = { remove_modifier = slreptilian_illusion_10 }
			slreptilian_illusion_0 = { remove_modifier = slreptilian_illusion_0 }
		}
	}
	else_if = {
		limit = {
			pop_percentage = {
				percentage > @enslaved_percentage_low
				limit = { is_enslaved = yes }
			}
		}
		if = {
			limit = { NOT = { has_modifier = slreptilian_illusion_20 } }
			add_modifier = { modifier = slreptilian_illusion_20 }
		}
		switch = {
			trigger = has_modifier
			slreptilian_illusion_40 = { remove_modifier = slreptilian_illusion_40 }
			slreptilian_illusion_30 = { remove_modifier = slreptilian_illusion_30 }
			slreptilian_illusion_10 = { remove_modifier = slreptilian_illusion_10 }
			slreptilian_illusion_0 = { remove_modifier = slreptilian_illusion_0 }
		}
	}
	else_if = {
		limit = {
			pop_percentage = {
				percentage > @enslaved_percentage_critical
				limit = { is_enslaved = yes }
			}
		}
		if = {
			limit = { NOT = { has_modifier = slreptilian_illusion_10 } }
			add_modifier = { modifier = slreptilian_illusion_10 }
		}
		switch = {
			trigger = has_modifier
			slreptilian_illusion_40 = { remove_modifier = slreptilian_illusion_40 }
			slreptilian_illusion_30 = { remove_modifier = slreptilian_illusion_30 }
			slreptilian_illusion_20 = { remove_modifier = slreptilian_illusion_20 }
			slreptilian_illusion_0 = { remove_modifier = slreptilian_illusion_0 }
		}
	}
	else_if = {
		limit = {
			pop_percentage = {
				percentage < @enslaved_percentage_none
				limit = { is_enslaved = yes }
			}
		}
		if = {
			limit = { NOT = { has_modifier = slreptilian_illusion_0 } }
			add_modifier = { modifier = slreptilian_illusion_0 }
		}
		switch = {
			trigger = has_modifier
			slreptilian_illusion_40 = { remove_modifier = slreptilian_illusion_40 }
			slreptilian_illusion_30 = { remove_modifier = slreptilian_illusion_30 }
			slreptilian_illusion_20 = { remove_modifier = slreptilian_illusion_20 }
			slreptilian_illusion_10 = { remove_modifier = slreptilian_illusion_10 }
		}
	}
}

# THIS = country
calculate_shadowyrep_happiness = {
	if = {
		limit = {
			pop_percentage = {
				percentage > @enslaved_percentage_high
				limit = { is_enslaved = yes }
			}
		}
		every_owned_pop = {
			switch = {
				trigger = has_modifier
				slreptilian_illusion_30 = { remove_modifier = slreptilian_happiness_30 }
				slreptilian_illusion_20 = { remove_modifier = slreptilian_happiness_20 }
				slreptilian_illusion_10 = { remove_modifier = slreptilian_happiness_10 }
				slreptilian_illusion_0 = { remove_modifier = slreptilian_happiness_0 }
			}
			if = {
				limit = {
					is_enslaved = yes
					NOT = { has_modifier = slreptilian_happiness_40 }
				}
				add_modifier = {
					modifier = slreptilian_happiness_40
					days = @enslaved_pop_modifier_duration_days
				}
			}
		}
	}
	else_if = {
		limit = {
			pop_percentage = {
				percentage > @enslaved_percentage_low
				limit = { is_enslaved = yes }
			}
		}
		every_owned_pop = {
			switch = {
				trigger = has_modifier
				slreptilian_illusion_40 = { remove_modifier = slreptilian_happiness_40 }
				slreptilian_illusion_20 = { remove_modifier = slreptilian_happiness_20 }
				slreptilian_illusion_10 = { remove_modifier = slreptilian_happiness_10 }
				slreptilian_illusion_0 = { remove_modifier = slreptilian_happiness_0 }
			}
			if = {
				limit = {
					is_enslaved = yes
					NOT = { has_modifier = slreptilian_happiness_30 }
				}
				add_modifier = {
					modifier = slreptilian_happiness_30
					days = @enslaved_pop_modifier_duration_days
				}
			}
		}
	}
	else_if = {
		limit = {
			pop_percentage = {
				percentage > @enslaved_percentage_low
				limit = { is_enslaved = yes }
			}
		}
		every_owned_pop = {
			switch = {
				trigger = has_modifier
				slreptilian_illusion_40 = { remove_modifier = slreptilian_happiness_40 }
				slreptilian_illusion_30 = { remove_modifier = slreptilian_happiness_30 }
				slreptilian_illusion_10 = { remove_modifier = slreptilian_happiness_10 }
				slreptilian_illusion_0 = { remove_modifier = slreptilian_happiness_0 }
			}
			if = {
				limit = {
					is_enslaved = yes
					NOT = { has_modifier = slreptilian_happiness_20 }
				}
				add_modifier = {
					modifier = slreptilian_happiness_20
					days = @enslaved_pop_modifier_duration_days
				}
			}
		}
	}
	else_if = {
		limit = {
			pop_percentage = {
				percentage > @enslaved_percentage_critical
				limit = { is_enslaved = yes }
			}
		}
		every_owned_pop = {
			switch = {
				trigger = has_modifier
				slreptilian_illusion_40 = { remove_modifier = slreptilian_happiness_40 }
				slreptilian_illusion_30 = { remove_modifier = slreptilian_happiness_30 }
				slreptilian_illusion_20 = { remove_modifier = slreptilian_happiness_20 }
				slreptilian_illusion_0 = { remove_modifier = slreptilian_happiness_0 }
			}
			if = {
				limit = {
					is_enslaved = yes
					NOT = { has_modifier = slreptilian_happiness_10 }
				}
				add_modifier = {
					modifier = slreptilian_happiness_10
					days = @enslaved_pop_modifier_duration_days
				}
			}
		}
	}
	else_if = {
		limit = {
			pop_percentage = {
				percentage < @enslaved_percentage_none
				limit = { is_enslaved = yes }
			}
		}
		every_owned_pop = {
			switch = {
				trigger = has_modifier
				slreptilian_illusion_40 = { remove_modifier = slreptilian_happiness_40 }
				slreptilian_illusion_30 = { remove_modifier = slreptilian_happiness_30 }
				slreptilian_illusion_20 = { remove_modifier = slreptilian_happiness_20 }
				slreptilian_illusion_0 = { remove_modifier = slreptilian_happiness_10 }
			}
			if = {
				limit = {
					is_enslaved = yes
					NOT = { has_modifier = slreptilian_happiness_0 }
				}
				add_modifier = {
					modifier = slreptilian_happiness_0
					days = @enslaved_pop_modifier_duration_days
				}
			}
		}
	}
}